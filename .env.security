# =============================================================================
# COGNISYNC SECURITY CONFIGURATION
# =============================================================================
# This file contains all security-related environment variables for the
# CogniSync platform. Copy this file to .env.security and customize values.

# =============================================================================
# AUTHENTICATION CONFIGURATION
# =============================================================================

# JWT Configuration
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production-64-chars-minimum
JWT_ISSUER=cognisync-platform
JWT_EXPIRES_IN=1h

# API Key Configuration
ENABLE_API_KEYS=true
ENABLE_JWT=true
ENABLE_SERVICE_TOKENS=true
API_KEY_PREFIX=cognisync
VALID_API_KEYS=key1,key2,key3

# Service-to-Service Authentication
SERVICE_AUTH_ENABLED=true
SERVICE_TOKEN_EXPIRY=15m

# =============================================================================
# AUTHORIZATION CONFIGURATION
# =============================================================================

# Role-Based Access Control
ENABLE_RBAC=true
ENABLE_SCOPE_VALIDATION=true
ENABLE_TENANT_ISOLATION=true

# Default Scopes
DEFAULT_SCOPES=read
ADMIN_SCOPES=admin,read,write,delete
SERVICE_SCOPES=read,write

# Tenant Isolation
TENANT_ISOLATION_ENABLED=true
DEFAULT_TENANT_ID=default

# =============================================================================
# ENCRYPTION CONFIGURATION
# =============================================================================

# Data Encryption
ENABLE_DATA_ENCRYPTION=true
ENABLE_TRANSIT_ENCRYPTION=true
ENCRYPTION_ALGORITHM=aes-256-gcm
ENCRYPTION_KEY_LENGTH=32
ENCRYPTION_KEY=your-32-byte-encryption-key-here

# =============================================================================
# MUTUAL TLS (mTLS) CONFIGURATION
# =============================================================================

# mTLS Settings
MTLS_ENABLED=true
MTLS_CERT_PATH=/etc/ssl/certs/service.crt
MTLS_KEY_PATH=/etc/ssl/private/service.key
MTLS_CA_PATH=/etc/ssl/certs/ca.crt
MTLS_VALIDATE=true
MTLS_ALLOWED_SERVICES=atlassian-sync-service,knowledge-graph-service,llm-rag-service
MTLS_ROTATION_INTERVAL=24

# =============================================================================
# RATE LIMITING CONFIGURATION
# =============================================================================

# Rate Limiting
ENABLE_RATE_LIMITING=true
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_SKIP_PATHS=/health,/metrics
TRUST_PROXY=true

# =============================================================================
# CORS CONFIGURATION
# =============================================================================

# Cross-Origin Resource Sharing
ENABLE_CORS=true
CORS_ORIGIN=https://your-domain.com,https://admin.your-domain.com
CORS_CREDENTIALS=true
CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_HEADERS=Content-Type,Authorization,x-api-key,x-tenant-id

# =============================================================================
# SECURITY HEADERS CONFIGURATION
# =============================================================================

# Security Headers
ENABLE_HSTS=true
ENABLE_CSP=true
ENABLE_X_FRAME_OPTIONS=true
ENABLE_X_CONTENT_TYPE_OPTIONS=true
ENABLE_REFERRER_POLICY=true

# Custom Security Headers (JSON format)
CUSTOM_SECURITY_HEADERS={"X-Custom-Header":"value","X-API-Version":"1.0"}

# =============================================================================
# AUDIT AND LOGGING CONFIGURATION
# =============================================================================

# Audit Logging
ENABLE_AUDIT_LOGGING=true
AUDIT_LEVEL=standard
LOG_FAILED_ATTEMPTS=true
LOG_SUCCESSFUL_ATTEMPTS=false
AUDIT_RETENTION_DAYS=90

# =============================================================================
# DEVELOPMENT CONFIGURATION
# =============================================================================

# Development Settings (only for development environment)
DISABLE_AUTH=false
ALLOW_INSECURE=false
DEBUG_LOGGING=false
MOCK_EXTERNAL_SERVICES=false

# =============================================================================
# SERVICE-SPECIFIC SECURITY SETTINGS
# =============================================================================

# Atlassian Sync Service
ATLASSIAN_SYNC_API_KEYS=AS-SYNC-PROD-KEY-1234567890abcdef,AS-SYNC-BACKUP-KEY-fedcba0987654321
ATLASSIAN_WEBHOOK_SECRET=your-atlassian-webhook-secret

# Knowledge Graph Service
KG_API_KEY=KG-PROD-KEY-1234567890abcdef1234567890abcdef
KG_SERVICE_SCOPES=read,write,admin

# LLM-RAG Service
LLM_RAG_API_KEYS=llm-rag-tenant1-key123,llm-rag-tenant2-key456
LLM_RAG_SERVICE_SCOPES=read,write,llm,embedding,analytics

# =============================================================================
# EXTERNAL SERVICE SECURITY
# =============================================================================

# OpenAI API Security
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_ORG_ID=org-your-openai-organization-id-here

# Pinecone Security
PINECONE_API_KEY=your-pinecone-api-key-here
PINECONE_ENVIRONMENT=your-pinecone-environment

# Azure Service Bus Security
AZURE_SERVICE_BUS_CONNECTION_STRING=Endpoint=sb://your-namespace.servicebus.windows.net/;SharedAccessKeyName=RootManageSharedAccessKey;SharedAccessKey=your-key

# =============================================================================
# CERTIFICATE MANAGEMENT
# =============================================================================

# Certificate Paths
SSL_CERT_PATH=/etc/nginx/ssl/cert.pem
SSL_KEY_PATH=/etc/nginx/ssl/key.pem
SSL_CA_PATH=/etc/nginx/ssl/ca.pem
SSL_DHPARAM_PATH=/etc/nginx/ssl/dhparam.pem

# Certificate Rotation
CERT_ROTATION_ENABLED=true
CERT_ROTATION_DAYS=30
CERT_AUTO_RENEWAL=true

# =============================================================================
# MONITORING AND ALERTING
# =============================================================================

# Security Monitoring
ENABLE_SECURITY_MONITORING=true
SECURITY_ALERT_WEBHOOK=https://your-monitoring-service.com/webhook
FAILED_AUTH_THRESHOLD=10
SUSPICIOUS_ACTIVITY_THRESHOLD=50

# =============================================================================
# COMPLIANCE AND GOVERNANCE
# =============================================================================

# Compliance Settings
ENABLE_GDPR_COMPLIANCE=true
ENABLE_SOC2_COMPLIANCE=true
DATA_RETENTION_DAYS=2555  # 7 years
PII_ENCRYPTION_REQUIRED=true

# =============================================================================
# BACKUP AND DISASTER RECOVERY
# =============================================================================

# Security Backup
SECURITY_CONFIG_BACKUP_ENABLED=true
SECURITY_CONFIG_BACKUP_INTERVAL=24h
SECURITY_CONFIG_BACKUP_LOCATION=s3://your-backup-bucket/security-configs/